CREATE DATABASE NewYorkers;
use NewYorkers;
CREATE TABLE DimDate
       (DateID         INTEGER PRIMARY KEY,
        DateKey        date,
        YearID         INTEGER,
        MonthID        INTEGER);

CREATE TABLE DimProduct
       (ProductID      bigint PRIMARY KEY,
        ProductKey     NVARCHAR(30),
        ProductKeyName NVARCHAR(30),
        WareGroupKey   NVARCHAR(30),
        SeasonKey      NVARCHAR(30));
        
CREATE TABLE DimStore
       (StoreID        bigint PRIMARY KEY,
        StoreKey       NVARCHAR(30),
        StoreDescription   NVARCHAR(30),
        IsActiveStore  smallint);

CREATE TABLE FactSales		
       (SalesID        bigint PRIMARY KEY,
        SalesDateID    INTEGER REFERENCES DateID,
        StoreID        bigint REFERENCES StoreID,
        ProductID      bigint REFERENCES ProductID,
        SalesQty	   INTEGER,
        SalesPrice     smallint);

INSERT INTO DimDate(DateID,	DateKey, YearID, MonthID) 
VALUES (19900101,	'1990-01-01',	1990,	199001),
	   (19900102,	'1990-01-02',	1990,	199001),
       (20190101,	'2019-01-01',	2019,	201901),
       (20190102,	'2019-01-02',	2019,	201901),
	   (20190103,	'2019-01-03',	2019,	201901),
	   (20190104,	'2019-01-04',	2019,	201901),
	   (20190105,	'2019-01-05',	2019,	201901),
	   (20190106,	'2019-01-06',	2019,	201901),
	   (20190107,	'2019-01-07',	2019,	201901),
	   (20190108,	'2019-01-08',	2019,	201901),
	   (20190109,	'2019-01-09',	2019,	201901),
       (20191230,	'2019-12-30',	2019,	201912),
	   (20191231,	'2019-12-31',   2019,	201912),
       (20201231,	'2020-12-31',	2020,	202012),
       (20991231,	'2099-12-31',	2099,	209912);
       
INSERT INTO DimProduct(ProductID, ProductKey, ProductKeyName, WareGroupKey,	SeasonKey) 
VALUES (1,	'01.02.250.0182',	'wht/red,mini,set',	'0102250',	'1'),
	   (2,	'01.02.250.0414',	'CV,BASIC,YELLOW,SLVLSS',	'0102250',	'1'),
	   (3,	'02.02.020.0190',	'PES/EL,Blk,waterfallTop',	'0202020',	'2'),
	   (4,	'02.02.020.0191',	'PES/EL,chmp,Waterfall',	'0202020',	'2'),
	   (5,	'03.01.200.0112',	'PES/EL,offsh,embr,Stwhit',	'0301200',	'1'),
	   (6,	'03.01.200.0113',	'PES/EL,offshldremb,rose',	'0301200',	'1'),
	   (7,	'06.04.105.0100',	'Polo Knitted Rib White',	'0604105',	'9'),
	   (8,	'06.04.105.0101',	'Polo Knitted Rib Black	',   '0604105',	 '9'),
	   (9,	'06.04.020.0001',	'RN Animal White Tiger',	'0604020',	'2'),
	   (10,	'06.04.020.0002',	'RN Animal White Monkey',	'0604020',	'2'),
	   (11,	'04.12.303.0001',	'CO AOP 1/2 blue palms',	'0412303',	'9'),
	   (12,	'04.12.303.0002',	'CO AOP 1/2 exotic flow',	'0412303',	'9'),
	   (13,	'05.03.010.0101',	'Tanktop Basic Black',	     '0503010',	'2'),
       (14,	'05.03.010.0102',	'Tanktop Basic White',	      '0503010', '2'),
	   (15, '05.03.010.0103',	'Tanktop Basic Grey Mel',	'0503010',	'2');
       
INSERT INTO DimStore (StoreID,	StoreKey,	StoreDescription,	IsActiveStore)
VALUES(1,	'1110007',	'KI Soho', 1),
	  (2,	'1110040',	'LÃ¼neburg',	1),
	  (3,	'1220074',	'Leipzig IV', 0),
	  (4,	'1220075',	'Erfurt', 1),
	  (5,	'2330722',	'Lienz', 1),
      (6,	'2330737',	'Liezen', -1),
	  (7,	'2380866',	'Olsztyn',	1),
      (8,	'2480010',	'Le Havre',	0),
	  (9,	'2480012',	'Roques', 1),
      (10,	'3200101',	'Neumarkt',	1);

INSERT INTO FactSales(SalesID,	SalesDateID,	StoreID,	ProductID,	SalesQty,	SalesPrice)
VALUES(1003535,	20100503, 1, 3,	1,	19.90),
	  (1003536,	20100503, 8, 1,	1,	24.90),
      (7003536, 20190108, 1, 1, 2, 9.90),
      (7003537,	20190108, 1, 5,	1, 14.90),
      (7003538,	20190108, 2, 4,	1,	19.90),
	(7003539,	20190108,	3,	7,	2,	4.90),
	(7003540, 20190108,	3, 8, 1, 39.90),
	(7003541,	20190108,	4,	1,	NULL, 2.90),
	(7003542,	20190108, 5, 3,	1,	19.90),
	(7003543, 20190108,	6,	10,	2, 24.90),
	(7003544, 20190108,	7,	4,	1,	49.90),
	(7003545, 20190108, 7, 8, 1, 29.90),
	(7003546,20190108,7,15,1, 19.90),
	(7003547,20190108,10,6,2,39.90),
    (7003548, 20190108,	10,	6, 1, 9.90),
	(7003549, 20190108,	10,	8, 1,14.90),
    (7839201, 0190116, 1, 7, 3,	4.90)	,	
	(7839202,	20190116, 1, 3,	1,	14.90),		
    (7839203,	20190116, 3, 4,	NULL, 39.90),		
	(7839204,20190116, 4, 9, 2, 19.90)		,
	(7839205,	20190116,	6,	12,	3,	3.90)	,	
	(7839206, 20190116,	6,	8,	3,	29.90)		,
	(7839207,	20190116,	7,	2,	2,	15.90)	,	
   (7839208,	20190116,	9,	1,	1,	7.90)	,	
	(7839209,	20190116,	10,	9,	1,	19.90),
    (8457827, 20190123, 2, 6, 1, 4.90),
	(8457828,	20190123,	4,	3,	2,	19.90),
	(8457829,	20190123,	7,	5,	1,	34.90),
	(8457830,	20190123,	7,	10,	2,	14.90),
(8457831, 20190123,	8,	11,	1,	-9.90),
(8457832, 20190123, 8, 15, 1, 1.90),
(8457833,	20190123,	9,	1,	3,	9.90),
(8457834,	20190123,	9,	10,	4,	24.90),
(8457835,	20190123,	9,	3,	NULL,	19.90),
(8457836,	20190123,	10,	6,	2,	9.90),
(9625342,	20191224,	3,	2,	1,	19.90),
(9625343,	20191224,	6,	4,	3,	29.90),
(9625344,	20191224,	8,	1,	2,	9.90),
(9625345,	20191224,	8,	5,	1,	-19.90),
(9625346,	20191224,	9,	9,	1,	19.90),
(9625347,	20191224,	10,	8,	1,	4.90),
(10003674,	20200219,	1,	3,	1,	9.90),
(10003675,	20200219,	6,	15,	2,	29.90),
(10003676,	20200219,	10,	11,	NULL,	24.90);


